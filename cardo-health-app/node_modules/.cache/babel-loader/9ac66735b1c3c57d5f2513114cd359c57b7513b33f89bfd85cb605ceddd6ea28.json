{"ast":null,"code":"import _slicedToArray from\"/Users/rafaelguerreroclemente/Documents/interviews/Cardo-Health/cardo-health-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _defineProperty from\"/Users/rafaelguerreroclemente/Documents/interviews/Cardo-Health/cardo-health-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import React,{useState}from'react';import{deleteBook,updateBook}from'../../services/books';import TextInput from'../TextInput';import'./styles.scss';import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var updateValue=function updateValue(update,key,value){return Object.assign({},update,_defineProperty({},key,value));};var renderEditBook=function renderEditBook(book,update,setUpdate){var updatedBook=Object.assign({},book,update);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TextInput,{name:\"Title\",value:updatedBook.title,onChange:function onChange(value){return setUpdate(updateValue(update,'title',value));}}),/*#__PURE__*/_jsx(TextInput,{name:\"ISBN\",value:updatedBook.isbn,onChange:function onChange(value){return setUpdate(updateValue(update,'isbn',value));}}),/*#__PURE__*/_jsx(TextInput,{name:\"Author\",value:updatedBook.author,onChange:function onChange(value){return setUpdate(updateValue(update,'author',value));}})]});};var renderBook=function renderBook(book){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Name: \"}),book.title]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"ISBN: \"}),book.isbn]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Author: \"}),book.author]})]});};var canSaveData=function canSaveData(book,update){return Object.keys(update).length>0&&!('isbn'in update&&!update.isbn)&&!(!book.isbn&&!update.isbn);};function Book(_ref){var book=_ref.book,onChange=_ref.onChange;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),update=_useState2[0],setUpdate=_useState2[1];var _useState3=useState(!book.isbn),_useState4=_slicedToArray(_useState3,2),isEdit=_useState4[0],setIsEdit=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];return/*#__PURE__*/_jsxs(\"div\",{className:\"comp-book\",children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{children:\"Saving...\"}),!isLoading&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comp-book-wrapper\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"/assets/book.png\",alt:\"book\"}),/*#__PURE__*/_jsx(\"div\",{className:\"comp-book-text\",children:isEdit?renderEditBook(book,update,setUpdate):renderBook(book)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comp-book-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"comp-book-btn comp-book-delete\",onClick:function onClick(){setIsLoading(true);deleteBook(book.isbn).then(onChange);},children:\"Delete\"}),book.isbn&&/*#__PURE__*/_jsx(\"button\",{className:\"comp-book-btn comp-book-edit\",onClick:function onClick(){setIsEdit(!isEdit);setUpdate({});},children:isEdit?'Cancel':'Edit'}),isEdit&&/*#__PURE__*/_jsx(\"button\",{className:\"comp-book-btn comp-book-save\",onClick:function onClick(){setIsLoading(true);updateBook(book.isbn,update).then(function(data){if(data.duplicated)window.alert('This isbn is already in use');}).then(function(){return setIsLoading(false);}).then(function(){return setIsEdit(false);}).then(onChange);},disabled:!canSaveData(book,update),children:\"Save\"})]})]})]});}export default Book;","map":{"version":3,"names":["React","useState","deleteBook","updateBook","TextInput","updateValue","update","key","value","Object","assign","renderEditBook","book","setUpdate","updatedBook","title","isbn","author","renderBook","canSaveData","keys","length","Book","onChange","isEdit","setIsEdit","isLoading","setIsLoading","then","data","duplicated","window","alert"],"sources":["/Users/rafaelguerreroclemente/Documents/interviews/Cardo-Health/cardo-health-app/src/components/Book/index.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { deleteBook, updateBook } from '../../services/books';\nimport TextInput from '../TextInput';\nimport './styles.scss';\n\nconst updateValue = (update, key, value) => {\n    return Object.assign({}, update, { [key]: value });\n};\n\nconst renderEditBook = (book, update, setUpdate) => {\n    const updatedBook = Object.assign({}, book, update);\n\n    return (\n        <>\n            <TextInput\n                name=\"Title\"\n                value={updatedBook.title}\n                onChange={(value) =>\n                    setUpdate(updateValue(update, 'title', value))\n                }\n            />\n            <TextInput\n                name=\"ISBN\"\n                value={updatedBook.isbn}\n                onChange={(value) =>\n                    setUpdate(updateValue(update, 'isbn', value))\n                }\n            />\n            <TextInput\n                name=\"Author\"\n                value={updatedBook.author}\n                onChange={(value) =>\n                    setUpdate(updateValue(update, 'author', value))\n                }\n            />\n        </>\n    );\n};\n\nconst renderBook = (book) => {\n    return (\n        <>\n            <p>\n                <b>Name: </b>\n                {book.title}\n            </p>\n            <p>\n                <b>ISBN: </b>\n                {book.isbn}\n            </p>\n            <p>\n                <b>Author: </b>\n                {book.author}\n            </p>\n        </>\n    );\n};\n\nconst canSaveData = (book, update) => {\n    return (\n        Object.keys(update).length > 0 &&\n        !('isbn' in update && !update.isbn) &&\n        !(!book.isbn && !update.isbn)\n    );\n};\n\nfunction Book({ book, onChange }) {\n    const [update, setUpdate] = useState({});\n    const [isEdit, setIsEdit] = useState(!book.isbn);\n    const [isLoading, setIsLoading] = useState(false);\n\n    return (\n        <div className=\"comp-book\">\n            {isLoading && <div>Saving...</div>}\n            {!isLoading && (\n                <>\n                    <div className=\"comp-book-wrapper\">\n                        <img src=\"/assets/book.png\" alt=\"book\" />\n                        <div className=\"comp-book-text\">\n                            {isEdit\n                                ? renderEditBook(book, update, setUpdate)\n                                : renderBook(book)}\n                        </div>\n                    </div>\n\n                    <div className=\"comp-book-actions\">\n                        <button\n                            className=\"comp-book-btn comp-book-delete\"\n                            onClick={() => {\n                                setIsLoading(true);\n\n                                deleteBook(book.isbn).then(onChange);\n                            }}\n                        >\n                            Delete\n                        </button>\n\n                        {book.isbn && (\n                            <button\n                                className=\"comp-book-btn comp-book-edit\"\n                                onClick={() => {\n                                    setIsEdit(!isEdit);\n                                    setUpdate({});\n                                }}\n                            >\n                                {isEdit ? 'Cancel' : 'Edit'}\n                            </button>\n                        )}\n\n                        {isEdit && (\n                            <button\n                                className=\"comp-book-btn comp-book-save\"\n                                onClick={() => {\n                                    setIsLoading(true);\n\n                                    updateBook(book.isbn, update)\n                                        .then((data) => {\n                                            if (data.duplicated)\n                                                window.alert(\n                                                    'This isbn is already in use'\n                                                );\n                                        })\n                                        .then(() => setIsLoading(false))\n                                        .then(() => setIsEdit(false))\n                                        .then(onChange);\n                                }}\n                                disabled={!canSaveData(book, update)}\n                            >\n                                Save\n                            </button>\n                        )}\n                    </div>\n                </>\n            )}\n        </div>\n    );\n}\n\nexport default Book;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}